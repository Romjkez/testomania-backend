# Testmania \ REST API
Серверная часть для мобильного приложения по созданию и прохождению тестов.

Содержание
- [API пользователя](#Пользователь)
- [API теста](#Тест)
- [Формат ошибок](#Ошибки)
- [Основные модели](#Модели)

## Пользователь
### Получение пользователя

- Метод: GET
- Путь: /user/:id
- Тело запроса (JSON): нет
- URL параметры: нет
- Формат ответа: объект `User` и ИЛИ [ошибка](#Ошибки)

### Получение нескольких пользователей

- Метод: GET
- Путь: /user/multiple/
- Тело запроса (JSON): нет
- URL параметры: 
    - `ids` - Array\<number> (массив из нужных id пользователей)
- Формат ответа: массив объектов `User` ИЛИ [ошибка](#Ошибки)


### Создание пользователя
- Метод: POST
- Путь: /user
- Тело запроса (JSON): 
    - `login`* - string (логин пользователя)
    - `password`* - string (пароль пользователя, не менее 6 символов)
    - `email` - string (эл. почта пользователя)
- URL параметры: нет
- Формат ответа: объект `User` ИЛИ [ошибка](#Ошибки)

\* - обязательные поля
### Авторизация пользователя
- Метод: GET
- Путь: /user/auth
- Тело запроса (JSON): нет
- URL параметры: 
    - `login`* - string (логин пользователя, указанный при регистрации)
    - `password`* - string (пароль, указанный при регистрации)
- Формат ответа: объект
    - `correctPassword` - boolean (true, если пароль верный; false, если нет)
       
  ИЛИ [ошибка](#Ошибки)
  
### Удаление пользователя
- Метод: DELETE
- Путь: /user/:id
- Тело запроса (JSON): нет
- URL параметры: нет
- Формат ответа: объект `DeleteResult`
    - `raw` - object (результат SQL запроса)
    - `affected` - integer (кол-во удаленных строк)
    
    ИЛИ [ошибка](#Ошибки)
    
### Изменение пользователя
- Метод: PUT
- Путь: /user/:id
- Тело запроса (JSON): 
    - `password` - string (новый пароль)
    - `email` - string (новый email)
    - `finishedTests` - TestResult (завершенный тест)
    
Примечание: все поля необязательные

Модель `TestResult`
    - id - string (ID завершенного теста)
    - result - Array<boolean> (результаты ответов)

Пример `TestResult`:
```
{
  "id": 1, // завершен тест с ID 1
  "result": [true, true, false] // первые 2 ответа верные, 3-ий - неверный
}
```

- URL параметры: нет
- Формат ответа: объект `User` ИЛИ [ошибка](#Ошибки)


## Тест
### Получение тестов

- Метод: GET
- Путь: /test/
- Тело запроса (JSON): нет
- URL параметры:
    - `limit` - number (кол-во тестов, которое нужно получить - для пагинации )
        
        По умолчанию = 15
    - `offset` - number (отступ от начала списка тестов в БД - для пагинации)
    
        По умолчанию = 0
    - `sort` - string (сортировка тестов - `ASC`/`DESC`)
    
        По умолчанию = `DESC`
- Формат ответа: массив объектов `Test` и ИЛИ [ошибка](#Ошибки)

### Получение теста

- Метод: GET
- Путь: /test/:id
- Тело запроса (JSON): нет
- URL параметры: нет
- Формат ответа: объект `Test` и ИЛИ [ошибка](#Ошибки)

### Создание теста

- Метод: POST
- Путь: /test
- Тело запроса (JSON):
    - `title`* - string (название теста)
    - `createdBy`* - number (id пользователя, создавшего тест)
    - `description` - string (описание теста)
    - `questions` - Array\<Question> (список вопросов теста)
    
    Модель `Question`: 
    - `text`* - string (текст вопроса)
    - `options`* - Array\<string> (массив вариантов ответа)
    - `rightOptionId`* - number (ID элемента массива `options` с правильным ответом)
    
    Пример `Question`:
    ```
    {
      "text": "Сколько будет 2+2?",
      "options": ["2", "4", "6"],
      "rightOptionId": 1 // нумерация начинается с 0
    } 
    ```
- URL параметры: нет
- Формат ответа: объект `Test` ИЛИ [ошибка](#Ошибки)


### Удаление теста
- Метод: DELETE
- Путь: /test/:id
- Тело запроса (JSON): нет
- URL параметры: нет
- Формат ответа: объект `DeleteResult`
    - `raw` - object (результат SQL запроса)
    - `affected` - integer (кол-во удаленных строк)
    
    ИЛИ [ошибка](#Ошибки)

## Ошибки
Представляют из себя объект с полями:
- `statusCode` - HTTP код ошибки
- `error` - соответствующий HTTP коду текст ошибки
- `message` - текст ошибки, отправленный сервисом

Например:
```json
{
  "statusCode": 404,
  "error": "Not Found",
  "message": "Could not find any entity of type \"User\" matching: \"31123\""
}
```

## Модели
Описание сущностей `TestResult`, `User`, `Test`, `Question`
![Модель данных](https://i.imgur.com/8HmkpMi.png)
